#!/usr/local/bin/newt

Require("NSUnit");

/**
 * Rough testing of NSUnit.
 */

begin

	NSUnit := GetGlobalVar('|NSUnit:makkintosshu|);
	if NSUnit == NIL then Print("Couldn't get global var!\n");
	
	// protoNSUnitTestCase:AssertTrue() tests
	playground := { testCase: { _proto: NSUnit.protoNSUnitTestCase } };
	Print("AssertTrue(true): ");
	try
		playground.testCase:AssertTrue(true);
		Print("OK\n");
	onexception |evt.ex.msg.assert| do Print ("FAIL\n");
	Print("AssertTrue(nil): ");
	try
		playground.testCase:AssertTrue(nil);
		Print("FAIL\n");
	onexception |evt.ex.msg.assert| do Print("OK\n");
	Print("AssertTrue(\"some string\"): ");
	try
		playground.testCase:AssertTrue("some string");
		Print("FAIL\n");
	onexception |evt.ex.msg.assert| do Print("OK\n");
	
	// protoNSUnitTestCase:AssertNil() tests
	playground := { testCase: { _proto: NSUnit.protoNSUnitTestCase } };
	Print("AssertNil(nil): ");
	try
		playground.testCase:AssertNil(nil);
		Print("OK\n");
	onexception |evt.ex.msg.assert| do Print ("FAIL\n");
	Print("AssertNil(true): ");
	try
		playground.testCase:AssertNil(true);
		Print("FAIL\n");
	onexception |evt.ex.msg.assert| do Print("OK\n");
	Print("AssertNil(\"some string\"): ");
	try
		playground.testCase:AssertNil("some string");
		Print("FAIL\n");
	onexception |evt.ex.msg.assert| do Print("OK\n");
	
	// protoNSUnitTestCase:AssertEquals() tests
	playground := { testCase: { _proto: NSUnit.protoNSUnitTestCase } };
	Print("AssertEquals(1,1): ");
	try
		playground.testCase:AssertEquals(1, 1);
		Print("OK\n");
	onexception |evt.ex.msg.assert| do Print("FAIL\n");
	Print("AssertEquals(0,1): ");
	try
		playground.testCase:AssertEquals(0, 1);
		Print("FAIL\n");
	onexception |evt.ex.msg.assert| do Print("OK\n");
	Print("AssertEquals(\"some string\",\"some string\"): ");
	try
		playground.testCase:AssertEquals("some string", "some string");
		Print("OK\n");
	onexception |evt.ex.msg.assert| do Print("FAIL\n");
	Print("AssertEquals(\"some string\",\"some other string\"): ");
	try
		playground.testCase:AssertEquals("some string", "some other string");
		Print("FAIL\n");
	onexception |evt.ex.msg.assert| do Print("OK\n");
	
	// protoNSUnitTestCase:AssertNotEquals() tests
	playground := { testCase: { _proto: NSUnit.protoNSUnitTestCase } };
	Print("AssertNotEquals(1,1): ");
	try
		playground.testCase:AssertNotEquals(1, 1);
		Print("FAIL\n");
	onexception |evt.ex.msg.assert| do Print("OK\n");
	Print("AssertNotEquals(0,1): ");
	try
		playground.testCase:AssertNotEquals(0, 1);
		Print("OK\n");
	onexception |evt.ex.msg.assert| do Print("FAIL\n");
	Print("AssertNotEquals(\"some string\",\"some string\"): ");
	try
		playground.testCase:AssertNotEquals("some string", "some string");
		Print("FAIL\n");
	onexception |evt.ex.msg.assert| do Print("OK\n");
	Print("AssertNotEquals(\"some string\",\"some other string\"): ");
	try
		playground.testCase:AssertNotEquals("some string", "some other string");
		Print("OK\n");
	onexception |evt.ex.msg.assert| do Print("FAIL\n");
	
	// protoNSUnitTestCase:AssertGreaterThan() tests
	playground := { testCase: { _proto: NSUnit.protoNSUnitTestCase } };
	Print("AssertGreaterThan(1,0): ");
	try
		playground.testCase:AssertGreaterThan(1, 0);
		Print("FAIL\n");
	onexception |evt.ex.msg.assert| do Print("OK\n");
	Print("AssertGreaterThan(1,1): ");
	try
		playground.testCase:AssertGreaterThan(1, 1);
		Print("FAIL\n");
	onexception |evt.ex.msg.assert| do Print("OK\n");
	Print("AssertGreaterThan(0,1): ");
	try
		playground.testCase:AssertGreaterThan(0, 1);
		Print("OK\n");
	onexception |evt.ex.msg.assert| do Print("FAIL\n");
	
	// protoNSUnitTestCase:AssertGreaterThanOrEqual() tests
	playground := { testCase: { _proto: NSUnit.protoNSUnitTestCase } };
	Print("AssertGreaterThanOrEqual(1,0): ");
	try
		playground.testCase:AssertGreaterThanOrEqual(1, 0);
		Print("FAIL\n");
	onexception |evt.ex.msg.assert| do Print("OK\n");
	Print("AssertGreaterThanOrEqual(1,1): ");
	try
		playground.testCase:AssertGreaterThanOrEqual(1,1);
		Print("OK\n");
	onexception |evt.ex.msg.assert| do Print("FAIL\n");
	Print("AssertGreaterThanOrEqual(0,1): ");
	try
		playground.testCase:AssertGreaterThanOrEqual(0, 1);
		Print("OK\n");
	onexception |evt.ex.msg.assert| do Print("FAIL\n");
	
	// protoNSUnitTestCase:AssertLessThan() tests
	playground := { testCase: { _proto: NSUnit.protoNSUnitTestCase } };
	Print("AssertLessThan(1,0): ");
	try
		playground.testCase:AssertLessThan(1, 0);
		Print("OK\n");
	onexception |evt.ex.msg.assert| do Print("FAIL\n");
	Print("AssertLessThan(1,1): ");
	try
		playground.testCase:AssertLessThan(1, 1);
		Print("FAIL\n");
	onexception |evt.ex.msg.assert| do Print("OK\n");
	Print("AssertLessThan(0,1): ");
	try
		playground.testCase:AssertLessThan(0, 1);
		Print("FAIL\n");
	onexception |evt.ex.msg.assert| do Print("OK\n");
	
	// protoNSUnitTestCase:AssertLessThanOrEqual() tests
	playground := { testCase: { _proto: NSUnit.protoNSUnitTestCase } };
	Print("AssertLessThanOrEqual(1,0): ");
	try
		playground.testCase:AssertLessThanOrEqual(1, 0);
		Print("OK\n");
	onexception |evt.ex.msg.assert| do Print("FAIL\n");
	Print("AssertLessThanOrEqual(1,1): ");
	try
		playground.testCase:AssertLessThanOrEqual(1, 1);
		Print("OK\n");
	onexception |evt.ex.msg.assert| do Print("FAIL\n");
	Print("AssertLessThanOrEqual(0, 1): ");
	try
		playground.testCase:AssertLessThanOrEqual(0, 1);
		Print("FAIL\n");
	onexception |evt.ex.msg.assert| do Print("OK\n");
	
	// protoNSUtitTestCase:AssertFrameContainsSlot() tests
	playground := { testCase: { _proto: NSUnit.protoNSUnitTestCase }, testFrame: { someSlot: "something" } };
	Print("testFrame: { someSlot: \"something\" }\n");
	Print("AssertFrameContainsSlot(testFrame 'someSlot): ");
	try
		playground.testCase:AssertFrameContainsSlot(playground.testFrame, 'someSlot);
		Print("OK\n");
	onexception |evt.ex.msg.assert| do Print("FAIL\n");
	Print("AssertFrameContainsSlot(testFrame 'anotherSlot): ");
	try
		playground.testCase:AssertFrameContainsSlot(playground.testFrame, 'anotherSlot);
		Print("FAIL\n");
	onexception |evt.ex.msg.assert| do Print("OK\n");
	
	// protoNSUnitTestCase:Run() tests
	playground := { testCase: { _proto: NSUnit.protoNSUnitTestCase } };
	playground.testCase:Run();
	Print("Assertions:" && testCase.assertions & "\n");
	Print("Passing Tests:" && testCase.passes & "\n");
	Print("Failing Tests:" && testCase.fails & "\n");
	
end;
